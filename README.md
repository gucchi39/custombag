# OSHI BAG BUILDER – Prototype

**推しが主役のバッグ、あなた仕様で。**

見せる×入るを、自由設計。推し活向けカスタムバッグの2Dビジュアルエディタ（フロントエンドのみのプロトタイプ）

## 🎯 機能

- **2Dエディタ**: バッグにクリア窓・ポケット・バッジパネルを自由配置
- **フィットチェック**: 持ち物の影をドロップして入るかを確認
- **概算見積**: リアルタイムで価格を計算・表示
- **縫い代ガイド**: 10mm縫い代の侵入警告
- **缶バッジ敷き詰め**: バッジパネルに57/75mm缶バッジを格子配置
- **エクスポート**: PNG/PDF/JSON形式で出力
- **共有**: 圧縮コードでデザインをコピー&ペースト共有
- **ブラウザ保存**: LocalStorageで自動/手動保存
- **Undo/Redo**: 10ステップの操作履歴

## 🚀 セットアップ

### 必要環境
- Node.js 18以上
- npm または pnpm

**Node.jsをお持ちでない場合:**
1. [Node.js公式サイト](https://nodejs.org/)からLTS版をダウンロード
2. インストーラーを実行してインストール
3. コマンドプロンプトまたはPowerShellで `node -v` を実行して確認

### インストール

```bash
# npmの場合
npm install

# pnpmの場合（推奨）
pnpm install
```

### 開発サーバー起動

**方法1: ダブルクリックで起動（簡単！）**
```
📁 プロジェクトフォルダの「起動.bat」をダブルクリック
```

**方法2: VS Codeで自動起動**
- プロジェクトフォルダを開くと自動的に起動します
- または、`Ctrl+Shift+P` → "Run Task" → "開発サーバー起動"

**方法3: コマンドラインで起動**
```bash
# npmの場合
npm run dev

# pnpmの場合
pnpm dev
```

ブラウザで http://localhost:5173 を開く

### ビルド

```bash
# npmの場合
npm run build

# pnpmの場合
pnpm build
```

### テスト

```bash
# ユニットテスト
npm test  # または pnpm test

# E2Eテスト（初回のみPlaywrightのブラウザをインストール）
npm run install-playwright  # または pnpm install-playwright
npm run test:e2e  # または pnpm test:e2e
```

## 📁 プロジェクト構造

```
src/
├── pages/           # ページコンポーネント（Home/Design/Gallery）
├── components/      # 再利用可能なUIコンポーネント
│   ├── canvas/     # Konva関連（レイヤー/要素/ガイド）
│   ├── ui/         # 汎用UI（Button/Card/Toast等）
│   └── layout/     # レイアウト（Header/Footer等）
├── state/          # Zustand状態管理
├── modules/        # ビジネスロジック
│   ├── price/     # 価格計算
│   ├── pack/      # 缶バッジ敷き詰め
│   └── collision/ # 当たり判定
├── utils/          # ユーティリティ
│   └── export/    # PNG/PDF/JSON/共有コード
├── data/           # マスターデータ（ItemLibrary/Seed）
├── config/         # 設定（価格レート等）
├── types/          # TypeScript型定義
└── tests/          # テストファイル
```

## 💾 保存・共有・エクスポート

### 保存
- **自動保存**: 編集時に自動的にLocalStorageへ保存
- **手動保存**: 右上の保存ボタンでも保存可能
- データは `oshi_bag_designs` キーでブラウザに保存

### 共有コード
1. エディタ右上の「共有コードをコピー」ボタンをクリック
2. コードをコピーして他の人と共有
3. 受け取った人はギャラリーページの「共有コードを読み込み」に貼り付け
4. デザインが完全に復元されます

### エクスポート
- **PNG**: キャンバスを画像として保存
- **PDF**: A4縦、表紙＋寸法図＋BOM（材料表）を含む
- **JSON**: デザインの生データ（将来的なバックエンド連携用）

## 🎨 使い方

1. **ホーム画面**: プリセットを選ぶか「カスタムをはじめる」
2. **エディタ画面**:
   - 左: アイテム/要素ライブラリからドラッグ&ドロップ
   - 中央: キャンバスで配置・編集
   - 右: プロパティ編集＆見積表示
3. **ギャラリー**: 保存したデザインを管理

### 操作方法
- **追加**: 左パネルからキャンバスにドラッグ
- **移動**: 要素をドラッグ（5mmスナップ）
- **サイズ変更**: 右パネルの数値入力
- **削除**: 要素を選択して Delete キー or 削除ボタン
- **複製**: 要素を選択して Ctrl+D
- **Undo/Redo**: Ctrl+Z / Ctrl+Y

## ⚠️ 注意事項

- このプロトタイプは**デモ用**です
- 価格は**仮想**であり、実際の製造コストではありません
- バックエンド・認証・決済機能はありません
- すべてブラウザ内で動作します（オフライン可）

## 🧪 技術スタック

- **フレームワーク**: Vite + React 18 + TypeScript
- **状態管理**: Zustand
- **UI**: Tailwind CSS
- **2Dキャンバス**: Konva.js (react-konva)
- **PDF生成**: jsPDF + html2canvas
- **圧縮**: lz-string
- **テスト**: Vitest + Playwright

## 📄 ライセンス

MIT License - プロトタイプ/学習目的での使用を想定
